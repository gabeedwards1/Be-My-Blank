<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Be My ___ â€” Holiday Message Generator</title>
<style>
  :root{
    --bg:#0f1220; --panel:#11152b; --ink:#e8ecff; --muted:#b9c0d9; --accent:#7aa2ff; --ring:rgba(122,162,255,.35);
    --radius:16px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%}
  body{
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    background: radial-gradient(1200px 600px at 20% -10%, #182042 0%, var(--bg) 60%);
    color:var(--ink); line-height:1.5;
    display:flex; align-items:center; justify-content:center; padding:24px;
  }
  .app{width:min(920px,100%); background:var(--panel); border-radius:var(--radius); padding:20px 22px; box-shadow:0 15px 60px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.05)}
  h1{font-size:1.6rem; margin:6px 0 14px}
  p.sub{color:var(--muted); margin:0 0 16px}
  .row{display:grid; gap:12px; grid-template-columns:1fr 1fr 1fr}
  .row > * {min-width:0}
  label{font-size:.9rem; color:var(--muted); display:block; margin:10px 0 6px}
  select,input[type=date]{width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.08); background:#0d1123; color:var(--ink); outline:none}
  .chk{display:flex; gap:10px; align-items:center}
  .card{background:#0c1021; border:1px solid rgba(255,255,255,.06); border-radius:14px; padding:14px; margin-top:14px}
  button{
    appearance:none; border:none; cursor:pointer; border-radius:12px; padding:10px 14px; color:#000;
    background:var(--accent); font-weight:600; box-shadow:0 6px 16px var(--ring)
  }
  button.secondary{background:#252b4a; color:var(--ink)}
  .flex{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
  .list{display:grid; gap:10px}
  .pill{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:100px; background:#151a33; border:1px solid rgba(255,255,255,.08); font-size:.9rem}
  .out{white-space:pre-wrap; background:#0b0f1f; border:1px dashed rgba(255,255,255,.15); padding:12px; border-radius:12px}
  .muted{color:var(--muted)}
  .right{margin-left:auto}
  .footer{margin-top:14px; font-size:.85rem; color:var(--muted)}
  a{color:#aecdff}
</style>
</head>
<body>
  <div class="app">
    <h1>Be My ___ â€” Holiday Message Generator</h1>
    <p class="sub">Pick a date & country. Weâ€™ll find holidays and craft copy-paste messages like â€œBe my turkey ğŸ¦ƒ â€” Happy Thanksgiving!â€.</p>

    <div class="row">
      <div>
        <label for="date">Date</label>
        <input id="date" type="date" />
      </div>
      <div>
        <label for="country">Country (official holidays)</label>
        <select id="country"></select>
      </div>
      <div>
        <label>&nbsp;</label>
        <div class="flex">
          <button id="go">Generate</button>
          <button id="today" class="secondary">Today</button>
        </div>
      </div>
    </div>

    <div class="flex" style="margin-top:10px">
      <label class="chk"><input type="checkbox" id="includeOfficial" checked/> <span>Include official holidays</span></label>
      <label class="chk"><input type="checkbox" id="includeFun" checked/> <span>Include â€œsillyâ€ holidays</span></label>
      <label class="chk"><input type="checkbox" id="bundle"/> <span>One combined message per day</span></label>
      <span class="right muted" id="status"></span>
    </div>

    <div class="card">
      <div class="flex">
        <strong>Holidays found</strong>
        <button id="shuffle" class="secondary right">Shuffle Emojis</button>
      </div>
      <div id="holidays" class="list" style="margin-top:10px"></div>
    </div>

    <div class="card">
      <div class="flex">
        <strong>Generated message(s)</strong>
        <div class="right flex">
          <button id="copy">Copy</button>
          <button id="regenerate" class="secondary">Regenerate</button>
        </div>
      </div>
      <div id="output" class="out" style="margin-top:10px"></div>
    </div>

    <div class="footer">
      Sources: Official holidays from <a href="https://date.nager.at/API" target="_blank" rel="noreferrer">Nager.Date API</a> (free & CORS-enabled). â€œSillyâ€ holidays from a built-in list you can extend.
    </div>
  </div>

<script>
/* ---------- tiny data + helpers ---------- */
const COUNTRY_LIST = [
  ["US","United States"],["CA","Canada"],["GB","United Kingdom"],
  ["AU","Australia"],["IE","Ireland"],["DE","Germany"],["FR","France"]
];

const FUN_HOLIDAYS = {
  "01-01": ["New Yearâ€™s Day (Fun)","Bloody Mary Day"],
  "02-14": ["Valentineâ€™s (Fun)","International Book Giving Day"],
  "03-14": ["Pi Day","Potato Chip Day"],
  "03-17": ["St. Patrickâ€™s (Fun)"],
  "04-01": ["April Foolsâ€™ Day"],
  "05-04": ["Star Wars Day"],
  "06-01": ["Say Something Nice Day"],
  "09-19": ["Talk Like a Pirate Day"],
  "10-09": ["Leif Erikson Day"],
  "10-31": ["Halloween (Fun)"],
  "11-13": ["World Kindness Day"],
  "11-23": ["Espresso Day"],
  "12-25": ["Christmas (Fun)"]
};

const TEMPLATES = {
  "st patrick": "shamrock",
  "leif erikson": "viking",
  "valentine": "valentine",
  "thanksgiving": "turkey",
  "halloween": "pumpkin",
  "christmas": "tree",
  "new year": "firework",
  "talk like a pirate": "parrot",
  "pi": "pi",
  "coffee":"coffee", "espresso":"coffee",
  "donut":"donut","pizza":"pizza","taco":"taco"
};

const EMOJI = {
  shamrock:["â˜˜ï¸","ğŸ€"], viking:["ğŸ›¡ï¸","âš”ï¸","ğŸª–"], valentine:["ğŸ’˜","ğŸ’–","ğŸ’Œ"],
  turkey:["ğŸ¦ƒ","ğŸ—"], pumpkin:["ğŸƒ"], tree:["ğŸ„","ğŸŒ²"], firework:["ğŸ†","ğŸ‡"],
  parrot:["ğŸ¦œ","ğŸ´â€â˜ ï¸"], pi:["ğŸ¥§","ğŸ”¢"], coffee:["â˜•ï¸","ğŸ’¤"], donut:["ğŸ©"], pizza:["ğŸ•"], taco:["ğŸŒ®"],
  default:["ğŸ‰","ğŸˆ","âœ¨","ğŸ¥³","ğŸŒŸ","ğŸ˜Š","ğŸ’«"]
};

/* ----- LOCAL-DATE UTILITIES (no UTC!) ----- */
function toYMDLocal(d){
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,'0');
  const day = String(d.getDate()).padStart(2,'0');
  return `${y}-${m}-${day}`;
}
function toMMDDLocal(d){
  const m = String(d.getMonth()+1).padStart(2,'0');
  const day = String(d.getDate()).padStart(2,'0');
  return `${m}-${day}`;
}
/* Parse "YYYY-MM-DD" from <input type="date"> as a LOCAL date.
   Set time to noon to dodge DST-midnight edge cases. */
function fromInputLocal(value){
  if(!value){ return new Date(); }
  const [y,m,d] = value.split('-').map(Number);
  return new Date(y, m-1, d, 12, 0, 0);
}
/* Today for the date input, as local yyyy-mm-dd */
function todayInputValue(){
  return toYMDLocal(new Date());
}
function titleCase(s){ return s.replace(/\b([a-z])/g, m=>m.toUpperCase()); }

/* ---------- DOM refs ---------- */
const dateEl = document.getElementById('date');
const countryEl = document.getElementById('country');
const statusEl = document.getElementById('status');
const holidaysEl = document.getElementById('holidays');
const outputEl = document.getElementById('output');
const includeOfficialEl = document.getElementById('includeOfficial');
const includeFunEl = document.getElementById('includeFun');
const bundleEl = document.getElementById('bundle');

dateEl.value = todayInputValue();
COUNTRY_LIST.forEach(([code,name])=>{
  const o=document.createElement('option'); o.value=code; o.textContent=`${name} (${code})`;
  countryEl.appendChild(o);
});

/* ---------- core ---------- */
async function fetchOfficial(dateLocal, country){
  // Nager.Date returns ISO dates (YYYY-MM-DD). We'll compare with our local YMD string.
  const y = dateLocal.getFullYear();
  const url = `https://date.nager.at/api/v3/PublicHolidays/${y}/${country}`;
  const res = await fetch(url, {mode:'cors'});
  if(!res.ok) throw new Error(`Nager.Date ${res.status}`);
  const all = await res.json();
  const ymdLocal = toYMDLocal(dateLocal); // local-safe
  return all.filter(h=>h.date===ymdLocal).map(h=>h.name);
}

function fetchFun(dateLocal){
  return (FUN_HOLIDAYS[toMMDDLocal(dateLocal)] || []).slice();
}

function nounFromName(name){
  const low = name.toLowerCase();
  for(const key in TEMPLATES){
    if(low.includes(key)) return TEMPLATES[key];
  }
  const tokens = low.match(/[a-z]+/g) || [];
  let noun = "hero";
  for(let i=tokens.length-1;i>=0;i--){
    const t=tokens[i];
    if(["day","week","month","international","national","world","the"].includes(t)) continue;
    noun = t; break;
  }
  return noun;
}
function pickEmojis(noun){
  const arr = EMOJI[noun] || EMOJI.default;
  const copy = arr.slice(); const out=[];
  const n = Math.min(2, Math.max(1, Math.floor(Math.random()*2)+1));
  for(let i=0;i<n;i++){ out.push(copy[Math.floor(Math.random()*copy.length)]); }
  return out.join(" ");
}
function craftMessage(name){
  const noun = nounFromName(name);
  const pretty = titleCase(noun);
  const em = pickEmojis(noun);
  return `Be my ${pretty} ${em} â€” Happy ${name}!`;
}

async function generate(){
  statusEl.textContent = "Fetchingâ€¦";
  holidaysEl.innerHTML = "";
  outputEl.textContent = "";

  const dateLocal = fromInputLocal(dateEl.value);
  const country = countryEl.value || "US";
  let names = new Set();

  try{
    if(includeOfficialEl.checked){
      (await fetchOfficial(dateLocal, country)).forEach(n=>names.add(n));
    }
  }catch(e){
    console.warn(e);
    statusEl.textContent = "Official holidays unavailable; showing fun holidays only.";
  }
  if(includeFunEl.checked){
    fetchFun(dateLocal).forEach(n=>names.add(n));
  }

  const list = [...names];
  if(list.length===0){
    holidaysEl.innerHTML = `<div class="muted">No holidays found for this date.</div>`;
    outputEl.textContent = "";
    statusEl.textContent = "";
    return;
  }

  // render chips
  list.forEach(n=>{
    const el=document.createElement('span'); el.className='pill'; el.textContent=n;
    holidaysEl.appendChild(el);
  });

  // messages
  let messages = list.map(craftMessage);
  if(bundleEl.checked){
    const joined = list.map(n=>`â€¢ ${craftMessage(n)}`).join("\n");
    messages = [joined];
  }
  outputEl.textContent = messages.join("\n\n");
  statusEl.textContent = `Generated ${messages.length} message${messages.length>1?'s':''}.`;
}

function copyOut(){
  const text = outputEl.textContent.trim();
  if(!text){ return; }
  navigator.clipboard.writeText(text).then(()=>{
    statusEl.textContent = "Copied to clipboard âœ…";
  });
}

/* ---------- UI wiring ---------- */
document.getElementById('go').addEventListener('click', generate);
document.getElementById('today').addEventListener('click', ()=>{
  dateEl.value = todayInputValue(); generate();
});
document.getElementById('shuffle').addEventListener('click', ()=>{
  const pills = [...document.querySelectorAll('.pill')].map(p=>p.textContent);
  if(pills.length===0){ return; }
  let messages = pills.map(craftMessage);
  if(bundleEl.checked){
    messages = [pills.map(n=>`â€¢ ${craftMessage(n)}`).join("\n")];
  }
  outputEl.textContent = messages.join("\n\n");
  statusEl.textContent = "Refreshed emojis ğŸ²";
});
document.getElementById('copy').addEventListener('click', copyOut);
document.getElementById('regenerate').addEventListener('click', generate);

// initial render
generate();
</script>
